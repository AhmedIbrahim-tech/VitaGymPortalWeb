@using Core.ViewModels.MemberViewModels
@model CreateMemberViewModel
@{
    ViewData["Title"] = "Create Member";
}

<div class="card shadow-sm rounded-4 border-0 bg-white">
    <div class="card-body p-4 p-md-5">
        <div class="d-flex align-items-center gap-3 mb-4 pb-3 border-bottom border-2 border-light">
            <div class="bg-primary-subtle rounded-4 p-3">
                <i class="bi bi-person-plus fs-2 text-primary"></i>
            </div>
            <div>
                <h3 class="fw-semibold text-body-emphasis mb-1 lh-base">Add New Member</h3>
                <p class="text-muted mb-0">Fill in the member information below</p>
            </div>
        </div>

            @Html.ValidationMessage("DataMissed", new { @class = "alert alert-danger" })
            <form method="post" asp-action="CreateMember" enctype="multipart/form-data" novalidate>
                <!-- Personal Information Section -->
                <partial name="_FormSection" model="@("Personal Information")" view-data='new ViewDataDictionary(ViewData) { { "SectionIcon", "person-circle" }, { "SectionColor", "primary" } }' />
                <div class="row g-4">
                    <div class="col-12">
                        <label asp-for="FormFile" class="form-label fw-semibold">Profile Photo <span class="text-danger">*</span></label>
                        <div class="mb-3">
                            <img id="photoPreview" src="" alt="Photo Preview" 
                                 style="max-width: 150px; max-height: 150px; display: none;" 
                                 class="rounded-circle border border-3 border-primary shadow-sm" />
                        </div>
                        <input asp-for="FormFile" type="file" class="form-control form-control-lg rounded-3" accept="image/jpeg,image/jpg,image/png" id="photoInput" required/>
                        <span asp-validation-for="FormFile" class="text-danger small"></span>
                        <small class="form-text text-muted">Max size: 5 MB. Allowed types: JPG, PNG, JPEG</small>
                    </div>
                    <div class="col-md-6">
                        <label asp-for="Name" class="form-label fw-semibold">Full Name <span class="text-danger">*</span></label>
                        <input asp-for="Name" type="text" class="form-control form-control-lg rounded-3" placeholder="Enter full name"/>
                        <span asp-validation-for="Name" class="text-danger small"></span>
                    </div>
                    <div class="col-md-6">
                        <label asp-for="Email" class="form-label fw-semibold">Email <span class="text-danger">*</span></label>
                        <input asp-for="Email" type="email" class="form-control form-control-lg rounded-3" id="email" placeholder="Enter email address">
                        <span asp-validation-for="Email" class="text-danger small"></span>
                    </div>
                    <div class="col-md-6">
                        <label asp-for="Phone" class="form-label fw-semibold">Phone <span class="text-danger">*</span></label>
                        <input asp-for="Phone" class="form-control form-control-lg rounded-3" id="phone" placeholder="Enter phone number">
                        <span asp-validation-for="Phone" class="text-danger small"></span>
                    </div>
                    <div class="col-md-6">
                        <label asp-for="DateOfBirth" class="form-label fw-semibold">Date of Birth <span class="text-danger">*</span></label>
                        <input asp-for="DateOfBirth" type="date" class="form-control form-control-lg rounded-3" id="dob">
                        <span asp-validation-for="DateOfBirth" class="text-danger small"></span>
                    </div>
                    <div class="col-md-6">
                        <label asp-for="Gender" class="form-label fw-semibold">Gender <span class="text-danger">*</span></label>
                        <select asp-for="Gender" class="form-select form-select-lg rounded-3" asp-items="Html.GetEnumSelectList<Gender>()">
                            <option value="">Select gender</option>
                        </select>
                        <span asp-validation-for="Gender" class="text-danger small"></span>
                    </div>
                </div>

                <!-- Address Information Section -->
                <partial name="_FormSection" model="@("Address Information")" view-data='new ViewDataDictionary(ViewData) { { "SectionIcon", "geo-alt" }, { "SectionColor", "success" } }' />
                <div class="row g-4">
                    <div class="col-md-4">
                        <label asp-for="BuildingNumber" class="form-label fw-semibold">Building Number</label>
                        <input asp-for="BuildingNumber" class="form-control form-control-lg rounded-3" placeholder="e.g. 12">
                        <span asp-validation-for="BuildingNumber" class="text-danger small"></span>
                    </div>
                    <div class="col-md-4">
                        <label asp-for="Street" class="form-label fw-semibold">Street <span class="text-danger">*</span></label>
                        <input asp-for="Street" type="text" class="form-control form-control-lg rounded-3" id="street" placeholder="Enter street name">
                        <span asp-validation-for="Street" class="text-danger small"></span>
                    </div>
                    <div class="col-md-4">
                        <label asp-for="City" class="form-label fw-semibold">City <span class="text-danger">*</span></label>
                        <input asp-for="City" type="text" class="form-control form-control-lg rounded-3" id="city" placeholder="Enter city">
                        <span asp-validation-for="City" class="text-danger small"></span>
                    </div>
                </div>

                <!-- Health Record Section -->
                <partial name="_FormSection" model="@("Health Record")" view-data='new ViewDataDictionary(ViewData) { { "SectionIcon", "heart-pulse" }, { "SectionColor", "danger" } }' />
                <div class="row g-4">
                    <div class="col-md-3">
                        <label asp-for="HealthRecordViewModel.Height" class="form-label fw-semibold">Height (cm) <span class="text-danger">*</span></label>
                        <input asp-for="HealthRecordViewModel.Height" type="number" class="form-control form-control-lg rounded-3" id="height" placeholder="e.g. 175">
                        <span asp-validation-for="HealthRecordViewModel.Height" class="text-danger small"></span>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="HealthRecordViewModel.Weight" class="form-label fw-semibold">Weight (kg) <span class="text-danger">*</span></label>
                        <input asp-for="HealthRecordViewModel.Weight" type="number" class="form-control form-control-lg rounded-3" id="weight" placeholder="e.g. 70">
                        <span asp-validation-for="HealthRecordViewModel.Weight" class="text-danger small"></span>
                    </div>
                    <div class="col-md-3">
                        <label asp-for="HealthRecordViewModel.BloodType" class="form-label fw-semibold">Blood Type <span class="text-danger">*</span></label>
                        <select asp-for="HealthRecordViewModel.BloodType" id="blood" class="form-select form-select-lg rounded-3">
                            <option value="">Select type</option>
                            <option>A+</option>
                            <option>A-</option>
                            <option>B+</option>
                            <option>B-</option>
                            <option>AB+</option>
                            <option>AB-</option>
                            <option>O+</option>
                            <option>O-</option>
                        </select>
                        <span asp-validation-for="HealthRecordViewModel.BloodType" class="text-danger small"></span>
                    </div>
                    <div class="col-md-12">
                        <label asp-for="HealthRecordViewModel.Note" class="form-label fw-semibold">Health Notes</label>
                        <textarea asp-for="HealthRecordViewModel.Note" id="note" class="form-control rounded-3" rows="3" placeholder="Add any relevant health notes..."></textarea>
                    </div>
                </div>

                <!-- Submit Button -->
                <partial name="_ActionButtons" view-data='new ViewDataDictionary(ViewData) { { "CancelUrl", Url.Action("Index") }, { "SubmitText", "Save Member" }, { "SubmitIcon", "save" } }' />
            </form>

    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        // Preview photo before upload
        document.getElementById('photoInput').addEventListener('change', function(e) {
            var file = e.target.files[0];
            if (file) {
                var reader = new FileReader();
                reader.onload = function(e) {
                    var preview = document.getElementById('photoPreview');
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                }
                reader.readAsDataURL(file);
            }
        });
    </script>
}